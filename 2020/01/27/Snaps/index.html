<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>Snap简介 | Tao Zhang&#39;s Blog</title>
    <meta name="author" content="Tao Zhang">
    
    <meta name="description" content="Snap在 techopedia 上的定义是这样的： 

Ubuntu Snappy is a package manager originally created by Canonical for the Ubuntu Phone distribution. Packages are called “snaps” and are designed to work across different Linux distributions, not just Ubuntu.

Ubuntu tutorials提供了 Basic snap usages 介绍。本文基本上是基于这个简介的提炼。">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="Snap简介"/>
    <meta property="og:site_name" content="Tao Zhang&#39;s Blog"/>

    
    <meta property="og:image" content="undefined"/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="Tao Zhang&#39;s Blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="blue darken-4">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">Tao Zhang&#39;s Blog</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category " href="/tags" >
                            <i class="fa fa-bookmark "></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            关于
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            搜索
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav blue darken-4" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="http://ww2.sinaimg.cn/large/53aa8487jw1e436g8svuzj205005074e.jpg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">Tao Zhang / 张涛</p>
                        <p class="desc">数据处理专家/系统架构师/项目经理</p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    首页
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    归档
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category " href="/tags" >
                    <i class="fa fa-bookmark "></i>
                    
                    分类
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    关于
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    搜索
                </a>
            </li>
        
    </ul>

    <ul class="side-nav blue darken-4" id="category-menu">
    

            

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">搜索</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper blue darken-4">
        <span class="breadcrumb">当前位置（分类目录）</span>
        
            

        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>Snap简介</h1>
    


            </div>
            <time class="deep-orange-link-context" datetime="2020-01-27T08:02:00.000Z"><a href="/2020/01/27/Snaps/">2020-01-27</a></time>

            
    <div class="tags-row">
        
            <a href="/tags/ubuntu/" class="chip deep-orange">ubuntu</a>
        
            <a href="/tags/snap/" class="chip deep-orange">snap</a>
        
    </div>


            <div class="toc deep-orange-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#1-开始"><span class="section table-of-contents-text">1. 开始</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#1-1-安装-snapd-服务"><span class="section table-of-contents-text">1.1 安装 snapd 服务</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#2-安装与运行-snap"><span class="section table-of-contents-text">2. 安装与运行 snap</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-1-搜索一个-snap"><span class="section table-of-contents-text">2.1 搜索一个 snap</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-2-安装与运行"><span class="section table-of-contents-text">2.2 安装与运行</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#安装一个-snap"><span class="section table-of-contents-text">安装一个 snap</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#运行一个-snap"><span class="section table-of-contents-text">运行一个 snap</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-3-列出已安装的-snaps"><span class="section table-of-contents-text">2.3 列出已安装的 snaps</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#2-4-更新"><span class="section table-of-contents-text">2.4 更新</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#3-snap-的更多特性"><span class="section table-of-contents-text">3. snap 的更多特性</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-1-snap-能提供一个或多个命令"><span class="section table-of-contents-text">3.1 snap 能提供一个或多个命令</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-2-snap-能提供服务"><span class="section table-of-contents-text">3.2 snap 能提供服务</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#3-3-卸载-snap"><span class="section table-of-contents-text">3.3 卸载 snap</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#4-snap-的不同版本"><span class="section table-of-contents-text">4. snap 的不同版本</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-1-切换其他版本"><span class="section table-of-contents-text">4.1 切换其他版本</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#4-2-退回"><span class="section table-of-contents-text">4.2 退回</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#5-其他资源"><span class="section table-of-contents-text">5. 其他资源</span></a></li></ol>
</div>


            <div class="entry deep-orange-link-context">
                <p>Snap在 <a href="https://www.techopedia.com/definition/31316/ubuntu-snappy" target="_blank" rel="external">techopedia</a> 上的定义是这样的： </p>
<blockquote>
<p>Ubuntu Snappy is a package manager originally created by Canonical for the Ubuntu Phone distribution. Packages are called “snaps” and are designed to work across different Linux distributions, not just Ubuntu.</p>
</blockquote>
<p>Ubuntu tutorials提供了 <a href="https://tutorials.ubuntu.com/tutorial/basic-snap-usage" target="_blank" rel="external">Basic snap usages</a> 介绍。本文基本上是基于这个简介的提炼。<a id="more"></a></p>
<h1 id="1-开始"><a href="#1-开始" class="headerlink" title="1. 开始"></a>1. 开始</h1><h2 id="1-1-安装-snapd-服务"><a href="#1-1-安装-snapd-服务" class="headerlink" title="1.1 安装 snapd 服务"></a>1.1 安装 snapd 服务</h2><p><strong>snapd</strong> 是管理snap的服务，支持很多Linux：</p>
<ul>
<li>ubuntu</li>
<li>debian</li>
<li>suse</li>
<li>等等</li>
</ul>
<p>对于Ubuntu来说，16.04 LTS及以后版本都已自带 <strong>snapd</strong> 服务。之前的版本可以用如下方法进行安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt install snapd</div></pre></td></tr></table></figure>
<h1 id="2-安装与运行-snap"><a href="#2-安装与运行-snap" class="headerlink" title="2. 安装与运行 snap"></a>2. 安装与运行 snap</h1><h2 id="2-1-搜索一个-snap"><a href="#2-1-搜索一个-snap" class="headerlink" title="2.1 搜索一个 snap"></a>2.1 搜索一个 snap</h2><p>语法: </p>
<blockquote>
<p>$ snap find <em>part-of-snap-name</em></p>
</blockquote>
<p>比如说我们想搜索一个含有”hello”的snap：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ snap find hello</div><div class="line">hello-node-snap       1.0.2        bhdouglass      -    A simple hello world <span class="built_in">command</span></div><div class="line">hello-mdeslaur        2.10  mdeslaur    -   GNU Hello, the <span class="string">"hello world"</span> snap</div><div class="line">hello-snap      0.01    muhammad    -   GNU hello-snap, the <span class="string">"Hello, Snap!"</span> snap</div><div class="line">hello           2.10    canonical       -   GNU Hello, the <span class="string">"hello world"</span> snap</div><div class="line">hello-world     6.3     canonical       -   The <span class="string">'hello-world'</span> of snaps</div><div class="line">hello-sergiusens      1.0   sergiusens      -   hello world example</div><div class="line">hello-gabriell  0.1     gabriell    -   Qt Hello World example</div><div class="line">hello-bluet     0.1     bluet       -   Qt Hello World example</div><div class="line">so-hello-world  0.2     shadowen    -   the old classic</div><div class="line">hello-huge      1.0     noise       -   a really big snap</div></pre></td></tr></table></figure>
<p>搜索的返回结果包括：snap名字，版本号，作者，简述</p>
<h2 id="2-2-安装与运行"><a href="#2-2-安装与运行" class="headerlink" title="2.2 安装与运行"></a>2.2 安装与运行</h2><h3 id="安装一个-snap"><a href="#安装一个-snap" class="headerlink" title="安装一个 snap"></a>安装一个 snap</h3><p>语法：</p>
<blockquote>
<p>$ sudo snap install _snap_full<em>name</em></p>
</blockquote>
<p>例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo snap install hello</div><div class="line"></div><div class="line">hello (stable) 2.10 from <span class="string">'canonical'</span> installed</div></pre></td></tr></table></figure></p>
<p>注意，第一次安装 snap 的时候，snapd 会下载系统所需的 base snap，这会多消耗一些时间；后续再装其他 snaps 就快了。</p>
<h3 id="运行一个-snap"><a href="#运行一个-snap" class="headerlink" title="运行一个 snap"></a>运行一个 snap</h3><p>语法：</p>
<blockquote>
<p>$ _snap_full<em>name</em></p>
</blockquote>
<p>例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ hello</div><div class="line">Hello, world!</div></pre></td></tr></table></figure></p>
<h2 id="2-3-列出已安装的-snaps"><a href="#2-3-列出已安装的-snaps" class="headerlink" title="2.3 列出已安装的 snaps"></a>2.3 列出已安装的 snaps</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ snap list</div><div class="line">Name                Version Rev  Developer   Notes</div><div class="line">hello               2.10    20   canonical   -</div><div class="line">core        16.04.1 423  canonical   -</div></pre></td></tr></table></figure>
<p>注意，上面列出的那个 core snap 就是上文中提到的 base snap。</p>
<h2 id="2-4-更新"><a href="#2-4-更新" class="headerlink" title="2.4 更新"></a>2.4 更新</h2><p>实际上 snaps 会每天在后台自动更新。当然你也可以手动刷新：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ sudo snap refresh hello</div><div class="line">error: cannot refresh <span class="string">"hello"</span>: snap <span class="string">"hello"</span> has no updates available</div><div class="line"></div><div class="line">$ sudo snap refresh</div><div class="line">core updated</div><div class="line">hello 64.75 MB [=====================================&gt;___]   12s</div></pre></td></tr></table></figure>
<h1 id="3-snap-的更多特性"><a href="#3-snap-的更多特性" class="headerlink" title="3. snap 的更多特性"></a>3. snap 的更多特性</h1><h2 id="3-1-snap-能提供一个或多个命令"><a href="#3-1-snap-能提供一个或多个命令" class="headerlink" title="3.1 snap 能提供一个或多个命令"></a>3.1 snap 能提供一个或多个命令</h2><p>当安装了一个 snap_example 的时候，我们可以用 <code>snap_example.sub_command_name</code> 来使用其提供的各种命令</p>
<h2 id="3-2-snap-能提供服务"><a href="#3-2-snap-能提供服务" class="headerlink" title="3.2 snap 能提供服务"></a>3.2 snap 能提供服务</h2><p>服务就是长时间运行的命令。</p>
<p>比如你安装了 <code>shout</code> 这个 snap，那么你就可以通过 <a href="http://localhost:9000" target="_blank" rel="external">http://localhost:9000</a> 来与此服务交互</p>
<h2 id="3-3-卸载-snap"><a href="#3-3-卸载-snap" class="headerlink" title="3.3 卸载 snap"></a>3.3 卸载 snap</h2><p>语法：</p>
<blockquote>
<p>$ snap remove _snap_full<em>name</em></p>
</blockquote>
<p>例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo snap remove hello-world</div><div class="line"></div><div class="line">hello-world removed</div></pre></td></tr></table></figure></p>
<p>snap 及其依赖、相关联的用户数据，都将被清理干净。如果 snap 是一个服务，则该服务先被停止然后清除。</p>
<h1 id="4-snap-的不同版本"><a href="#4-snap-的不同版本" class="headerlink" title="4. snap 的不同版本"></a>4. snap 的不同版本</h1><p>与其他软件一样，各个开发队伍对其 snap 也提供以下几种版本：</p>
<ul>
<li><code>stable</code> 为稳定版；</li>
<li><code>candidate</code> 为尝鲜版，一般在稳定版发布前几日推出，以便用户可以尝鲜并测试；</li>
<li><code>beta</code> 为未完全完成但已达到某些里程碑节点的版本；</li>
<li><code>edge</code> 为刚刚开发出来的最前沿版本，仅通过冒烟测试，尚未充分测试</li>
</ul>
<p>默认安装 <code>stable</code> 版。</p>
<h2 id="4-1-切换其他版本"><a href="#4-1-切换其他版本" class="headerlink" title="4.1 切换其他版本"></a>4.1 切换其他版本</h2><p>强制切换其他版本的命令如下：</p>
<p>语法：</p>
<blockquote>
<p>$ sudo snap refresh _snap_full<em>name</em> –channel=_channel<em>name</em></p>
</blockquote>
<p>或</p>
<blockquote>
<p>sudo snap install _snap_full<em>name</em> –_channel<em>name</em></p>
</blockquote>
<p>例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo snap refresh hello --channel=beta</div><div class="line"></div><div class="line">hello (beta) 2.10.1 from <span class="string">'canonical'</span> refreshed</div></pre></td></tr></table></figure></p>
<p>这时，再调用 hello，执行的就是 beta 版的 hello 了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ hello</div><div class="line">Hello, snap padawan!</div></pre></td></tr></table></figure></p>
<h2 id="4-2-退回"><a href="#4-2-退回" class="headerlink" title="4.2 退回"></a>4.2 退回</h2><p>如果发现某一个版本有问题，snap 支持退回一个版本。</p>
<p>语法：</p>
<blockquote>
<p>$ sudo snap revert _snap_full<em>name</em></p>
</blockquote>
<p>例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ sudo snap revert hello</div><div class="line"></div><div class="line">hello reverted to 2.10</div><div class="line">$ hello</div><div class="line">Hello, world!</div></pre></td></tr></table></figure></p>
<h1 id="5-其他资源"><a href="#5-其他资源" class="headerlink" title="5. 其他资源"></a>5. 其他资源</h1><ul>
<li><p><a href="https://tutorials.ubuntu.com/tutorial/advanced-snap-usage" target="_blank" rel="external">Advanced snap usage</a></p>
</li>
<li><p><a href="https://tutorials.ubuntu.com/tutorial/create-your-first-snap" target="_blank" rel="external">Creating your first snap</a></p>
</li>
<li><p><a href="https://forum.snapcraft.io/" target="_blank" rel="external">snapcraft forum</a></p>
</li>
<li><p><a href="http://snapcraft.io/docs/" target="_blank" rel="external">Snapcraft.io documentation</a></p>
</li>
</ul>

            </div>
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large deep-orange">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="回到顶部"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="menu"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer blue darken-4 darken-1">
    
    <div class="container">
        <div class="row">
            
            <div class="social-group col m3 s12">
                <h5 class="white-text">社交</h5>
                
                    <a class="social-link" href="http://weibo.com/1403683975" target="_blank">
                        <i class="fa fa-2x fa-weibo"></i>
                    </a>
                
                    <a class="social-link" href="https://github.com/zhangtao75" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                    <a class="social-link" href="https://plus.google.com/u/0/108922458003185062440" target="_blank">
                        <i class="fa fa-2x fa-google-plus"></i>
                    </a>
                
            </div>
            

            
            <div class="col m9 s12">
                <h5 class="white-text">友情链接</h5>
                
                    <a class="social-link" href="http://raytaylorlin.com/" target="_blank">raytaylorism主题作者的技术博客</a>
                
                    <a class="social-link" href="https://github.com/raytaylorlin" target="_blank">Github地址（测试友情链接）</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright deep-orange-link-context">
        <div class="container">
            © 2016 example.com, All rights reserved.
            <p class="right" style="margin-top: 0;">本博客由 <a href="https://hexo.io">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();
            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('deep-orange lighten-2');

            
            // 添加new标签
            $('').append('<span class="new badge deep-orange"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword deep-orange lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword deep-orange lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
